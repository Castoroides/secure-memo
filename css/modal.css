/* =======================================
   1) Modal Base
======================================= */
.modal{
  position: fixed;
  inset: 0;
  z-index: 1000;

  display: flex;
  justify-content: center;
  align-items: flex-start;

  padding: 16px;
  box-sizing: border-box;
}

.modal.hidden{ display: none; }

.modal-backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.45);
}

.modal-panel{
  position: relative;
  margin-top: 8vh;

  width: min(92%, 350px);
  border-radius: 14px;
  padding: 16px;
  padding-top: 10px;

  background: var(--bg-container);
  color: var(--text-main);
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
}

/* =======================================
   2) Common Parts
======================================= */
.modal-header{
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.modal-title{
  font-size: 16px;
  font-weight: 750;
  margin: 0;
  letter-spacing: .01em;
}

.modal-header button{
  border: none;
  background: none;
  font-size: 18px;
  cursor: pointer;
  color: var(--text-main);
}

.account-email{
  font-size: 14px;
  opacity: 0.85;
}

/* Buttons */
.danger-btn{
  background: #e5533d;
  color: #fff;
  border: none;
  padding: 10px;
  border-radius: 8px;
  cursor: pointer;
}

.danger-btn--ghost{
  width: 100%;
  background: transparent;
  color: #e5533d;
  border: 1px solid rgba(229,83,61,.45);
}

:root[data-color-mode="dark"] .danger-btn--ghost{
  border: 1px solid rgba(229,83,61,.55);
}

/* Basic form block (旧setting-item：そのまま残す) */
.setting-item{
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-bottom: 14px;
}

.setting-item input,
.setting-item textarea,
.setting-item select{
  padding: 10px;
  border-radius: 8px;
  border: 1px solid var(--border-main);
  background: var(--bg-editor);
  color: var(--text-main);
}

.setting-item textarea{
  min-height: 120px;
  resize: vertical;
}

@media (max-width: 600px){
  .setting-item textarea{
    min-height: 160px;
    font-size: 16px; /* Androidのズーム防止 */
  }
}

/* =======================================
   3) Edit Modal (footer sticky)
======================================= */
#editModal .modal-panel{
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - 24px); /* 画面内に収める */
}

#editModal .edit-modal-body{
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

/* ここは元の var(--border-color) が存在しないので修正 */
#editModal .edit-modal-footer{
  position: sticky;
  bottom: 0;

  padding: 12px;
  background: var(--bg-container);
  border-top: 1px solid var(--border-main);
}

/* 保存ボタン（非アクティブ） */
#editModal #saveEdit{
  width: 100%;
  opacity: 0.6;

  background: var(--btn-secondary-bg, #bbb);
  color: var(--btn-secondary-text, #fff);

  transition: opacity .2s, background .2s;
}

/* dirty（アクティブ）時 */
#editModal #saveEdit.is-active{
  opacity: 1;
  background: #e5533d;
  color: #fff;
}

/* =======================================
   4) Settings Modal (整理デザイン)
======================================= */
.modal-panel--settings{
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - 24px);
}

.settings-body{
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding-top: 4px;
}

/* フッター固定（ログアウトなど） */
.settings-footer{
  position: sticky;
  bottom: 0;

  background: var(--bg-container);
  border-top: 1px solid var(--border-main);
  padding: 12px;
}

/* セクション */
.settings-section{
  padding: 12px 0;
  border-top: 1px solid rgba(127,127,127,.18);
}
.settings-section:first-child{
  border-top: none;
  padding-top: 4px;
}

.settings-section-title{
  font-size: 12px;
  letter-spacing: .06em;
  opacity: .65;
  margin: 0 0 10px;
  text-transform: uppercase;
}

/* 行（左ラベル / 右コントロール） */
.settings-row{
  display: grid;
  grid-template-columns: 1fr 140px;
  align-items: center;
  gap: 10px;
  padding: 10px 0;
}

.settings-row--stack{
  grid-template-columns: 1fr;
}

.settings-label{
  font-size: 14px;
  font-weight: 650;
  opacity: .92;
}

.settings-control select{
  width: 100%;
  padding: 10px 10px;
  border-radius: 10px;
  border: 1px solid var(--border-main);
  background: var(--bg-editor);
  color: var(--text-main);
}

/* 端末が狭いときは2段に */
@media (max-width: 360px){
  .settings-row{
    grid-template-columns: 1fr;
  }
}

/* 補足テキスト */
.settings-help{
  margin: 6px 0 0;
  font-size: 12px;
  line-height: 1.6;
  opacity: .68;
}

/* Upgradeをカードっぽく */
.upgrade-card{
  padding: 12px;
  border-radius: 14px;
  border: 1px solid rgba(127,127,127,.18);
  background: var(--bg-editor);
}

.upgrade-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 10px;
}

.upgrade-title{
  font-size: 14px;
  font-weight: 750;
}

.upgrade-badge{
  font-size: 11px;
  padding: 4px 8px;
  border-radius: 999px;
  border: 1px solid rgba(127,127,127,.25);
  opacity: .7;
}

/* =======================================
   5) Upgrade (既存 simple-upgrade)
   ※上の .upgrade-card を使うなら、下は残してもOK
======================================= */
.simple-upgrade{
  margin-top: 12px;
  padding: 14px;
  border-top: 1px solid var(--border-main);

  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.simple-upgrade-title{
  font-size: 14px;
  font-weight: 700;
  letter-spacing: .01em;
  opacity: .9;
}

/* SVGバナー枠 */
.simple-upgrade-banner{
  width: 100%;
  max-width: 260px;
  height: 90px;

  display: flex;
  align-items: center;
  justify-content: center;

  border-radius: 10px;
  background: var(--bg-container);
  border: 1px solid var(--border-main);
}

/* メインCTA */
.simple-upgrade-btn{
  appearance: none;
  -webkit-appearance: none;
  border: none;
  cursor: pointer;

  padding: 10px 16px;
  border-radius: 999px;

  font-size: 14px;
  font-weight: 700;

  color: #fff;
  background: var(--accent, #4a6cff);
}

/* 復元リンク */
.simple-upgrade-restore{
  appearance: none;
  -webkit-appearance: none;
  border: none;
  background: none;
  cursor: pointer;

  font-size: 12px;
  opacity: .65;
}

.simple-upgrade-restore:hover{
  opacity: .9;
}

/* =========================
   Settings modal overflow fix
========================= */

/* 100vhより "100dvh" のほうがスマホで安定（URLバー考慮） */
.modal-panel--settings{
  margin-top: 0;                 /* ← 8vh を打ち消す */
  max-height: calc(100dvh - 32px); /* modalのpadding(16*2)ぶん引く */
}

/* パネルが画面の中で上下中央寄りに収まるように */
#settingsModal{
  align-items: center; /* flex-start だと上に寄って下がはみ出やすい */
}

/* 中身はボディだけスクロール */
.modal-panel--settings{
  display: flex;
  flex-direction: column;
}
.modal-panel--settings .settings-body{
  min-height: 0;  /* ← flex内スクロールの定番。これがないと突き抜けることがある */
  overflow: auto;
}
/* =========================
   PC用：Settings modal bottom余白調整
========================= */

/* デスクトップ幅以上だけ適用 */
@media (min-width: 768px){

  /* パネル全体の最大高さを少し小さくする */
  .modal-panel--settings{
    max-height: calc(100dvh - 64px); /* ← 32px → 64px に増量 */
  }

  /* フッターのタップ/クリック余白を広げる */
  .settings-footer{
    padding-bottom: 20px; /* 12px → 20px */
  }
}